<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../dist/main.css">
  <title>Twitter register page</title>
</head>
<body class="bg-bleu h-screen w-screen flex ">
  <div class="m-auto w-[600px] h-[650px]  bg-black rounded-2xl">

    <div class="bg-black h-[10%]">
      <h2 class="text-twitter-white text-lg pt-3 pl-[12%]">Étapes 3/5</h2>
    </div>

    <div class="h-[90%] w-[72%] bg-white m-auto">
      <h1 class="text-3xl text-twitter-white bg-black h-[12%] pl-2">Créer votre compte</h1>
      <form action="" class="relative bg-black h-[88%]" >
        <p class="text-sm text-twitter-white mb-3">Saisir le code secret reçu par SMS </p>

        <input type="text" id="codeInput" class="hidden">
        <div id="otp" class="flex justify-between">
          <input class="mb-8 w-[12%] rounded bg-black text-twitter-white border border-[#333639] focus:outline-none focus:ring-2 focus:ring-[#1A8BD6] py-3 text-center placeholder-[#71767A]" maxlength="1" type="text" id="input1" placeholder="E">
          <input class="mb-8 w-[12%] rounded bg-black text-twitter-white border border-[#333639] focus:outline-none focus:ring-2 focus:ring-[#1A8BD6] py-3 text-center placeholder-[#71767A]" maxlength="1" type="text" id="input2" placeholder="9">
          <input class="mb-8 w-[12%] rounded bg-black text-twitter-white border border-[#333639] focus:outline-none focus:ring-2 focus:ring-[#1A8BD6] py-3 text-center placeholder-[#71767A]" maxlength="1" type="text" id="input3" placeholder="3">
          <input class="mb-8 w-[12%] rounded bg-black text-twitter-white border border-[#333639] focus:outline-none focus:ring-2 focus:ring-[#1A8BD6] py-3 text-center placeholder-[#71767A]" maxlength="1" type="text" id="input4" placeholder="B">
          <input class="mb-8 w-[12%] rounded bg-black text-twitter-white border border-[#333639] focus:outline-none focus:ring-2 focus:ring-[#1A8BD6] py-3 text-center placeholder-[#71767A]" maxlength="1" type="text" id="input5" placeholder="5">
          <input class="mb-8 w-[12%] rounded bg-black text-twitter-white border border-[#333639] focus:outline-none focus:ring-2 focus:ring-[#1A8BD6] py-3 text-center placeholder-[#71767A]" maxlength="1" type="text" id="input6" placeholder="4">
        </div>

        <submit class="absolute bottom-5 text-center w-full py-3 bg-[#777A7A] rounded-full text-[#080A0E] text-sm font-extrabold cursor-pointer">
          Suivant
        </submit>      
      </form>
    </div>

  </div>

  <script type="text/javascript">
    const inputs = document.querySelectorAll('#otp > *[id]');
    const codeInput = document.getElementById('codeInput');

    inputs.forEach((input, i) => {
      input.addEventListener('keyup', event => {
        /* console.log(input.value);
        console.log(codeInput.value); */
        codeInput.value = ''+input1.value+''+input2.value+''+input3.value+''+input4.value+''+input5.value+''+input6.value+'';
        checkInput();
        
        if (event.key==="Backspace") {
          // Backspace is touche supprimer
          // vider a value de l'input
          input.value='';

          // si l'input n'est pas le premier alors reculer d'1 input
          i !== 0 ? inputs[i - 1].focus() : null;

        } else {
            if (i === inputs.length - 1 && inputs[i].value.trim() !== '' && (47 < event.keyCode && event.keyCode < 58 || 64 < event.keyCode && event.keyCode < 91)) {
              
              input.value = (String.fromCharCode(event.keyCode)).toUpperCase();
              //console.log(input.value);
              const allInputsFilled = Array.from(inputs).every(input => input.value.trim() !== '');
              console.log(allInputsFilled);
              
              //codeInput.value = ''+input1.value+''+input2.value+''+input3.value+''+input4.value+''+input5.value+''+input6.value+'';
              //console.log(codeInput.value);
              //allInputsFilled ? checkInput() : null;
              // Array.from(inputs).every(input => input.value.trim() !== '') ? console.log('w') : null;
              // si la valeur saisie est sur le dernier input et que tous les inputs sont remplie retourner true


            } else if (47 < event.keyCode && event.keyCode < 58) {
                // les keyCode de 47 à 58 sont les chiffres du clavier

                // la valeur de l'input égale la touche saisie
                // input.value=event.key;
                input.value = String.fromCharCode(event.keyCode);
                // si je ne suis pas sur le dernier input apres avoir saisie ma valeur alors avancer d'1 input
                i !==inputs.length - 1 ? inputs[i + 1].focus() : null;

                /* // si la touche est pressé avec shift alors :
                if(event.shiftKey) {
                  // la valeur de l'input égale la touche saisie
                  input.value= event.key;
                  // si je ne suis pas sur le dernier input après avoir saisie ma valeur alors avancer d'1 input
                  i !== inputs.length - 1 ? inputs[i + 1].focus() : null;
                } */

                //Annuler l'evenement de base qui aurait pu etre associer a la toucbe
                event.preventDefault();

              } else if (64 < event.keyCode && event.keyCode < 91) {
                // les keyCode de 64 à 91 sont les lettres du clavier

                // la valeur de l'input égale la touche saisie
                input.value = String.fromCharCode(event.keyCode);

                //si je ne suis pas sur le dernier input apres avoir saisie ma valeur alors avancer d'1 input
                i !== inputs.length - 1 ? inputs[i + 1].focus() : null;

                //Annuler l'evenement de base qui aurait pu etre associer a la toucbe
                event.preventDefault();
              }
        }
      })
    })
  
    function checkInput() {
      const inputFilled =  codeInput.value.length == inputs.length;

        submit.classList.toggle('bg-[#777A7A]',!inputFilled);
        submit.classList.toggle('bg-twitter-white',inputFilled);
    }

    const submit = document.querySelector('submit');

    submit.addEventListener('click',() => {
      checkInput();

      const submitIsWhite = submit.classList.contains('bg-twitter-white');
      !submitIsWhite ? event.preventDefault() : null;
    })

  </script>
</body>
</html>